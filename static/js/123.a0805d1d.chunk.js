"use strict";(self.webpackChunkkaralos=self.webpackChunkkaralos||[]).push([[123],{3541:function(e,n,t){t.d(n,{l:function(){return x}});var r=t(1413),a=t(1474),i=t(9164),o=t(4841),l=t(9347),s=t(4554),u=t(7689),c=t(1087),d=t(1849),p=t(6819),f=t(184),h=function(e){return(0,f.jsx)(a.Z,(0,r.Z)((0,r.Z)({},e),{},{component:c.rU,to:"../".concat(e.value)}))},x=function(e){var n=(0,u.bS)(p.XA.admin),t=null===n||void 0===n?void 0:n.params["*"];return(0,f.jsx)(i.Z,{maxWidth:!1,disableGutters:!0,children:(0,f.jsxs)(o.Z,{elevation:1,sx:{bgcolor:function(e){return"".concat(e.palette.background.default," !important")}},children:[(0,f.jsxs)(l.Z,{sx:{px:(0,d.V)(24),pt:(0,d.V)(12)},value:t,children:[(0,f.jsx)(h,{label:"Upload",value:p.XA.adminUpload}),(0,f.jsx)(h,{label:"Manage",value:p.XA.adminManage})]}),(0,f.jsx)(s.Z,{p:4,children:e.children})]})})}},2123:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee}});var r,a=t(4165),i=t(5861),o=t(1413),l=t(9439),s=t(3433),u=t(168),c=t(2791),d=t(7726),p=t(90),f=t(5849),h=t(2419),x=t(5962),g=t(4567),v=t(977),Z=t(872),m=t(9823),j=t(1286),b=t(8639),C=t(5397),k=t(3717),y=t(6772),w=t(184),S=function(e){return e.droppable?(0,w.jsx)(k.Z,{}):"image"===e.fileType?(0,w.jsx)(y.Z,{}):null},T=t(1849),F=t(3006),V=t(4912),I=(0,V.styled)(F.Z)(r||(r=(0,u.Z)(["\n  && .MuiInputBase-input {\n    padding: ",";\n  }\n"])),(0,T.V)(3)),P=function(e){var n=(0,c.useState)(!1),t=(0,l.Z)(n,2),r=t[0],a=t[1],i=(0,c.useState)(!1),s=(0,l.Z)(i,2),u=s[0],d=s[1],p=e.node,f=p.id,h=p.droppable,k=p.data,y=p.text,F=(0,c.useState)(y),V=(0,l.Z)(F,2),P=V[0],D=V[1],z=24*e.depth,L=(0,c.useCallback)((function(n){n.stopPropagation(),e.onToggle(e.node.id)}),[e.onToggle]),M=(0,c.useCallback)((function(){d(!0)}),[]),R=(0,c.useCallback)((function(){D(y),d(!1)}),[y]),N=(0,c.useCallback)((function(e){D(e.target.value)}),[]),_=(0,c.useCallback)((function(){d(!1),e.onTextChange(f,P)}),[f,P,e]),A=(0,x.t0)(f,e.isOpen,e.onToggle);return(0,w.jsxs)("div",(0,o.Z)((0,o.Z)({className:"tree-node root",style:{paddingInlineStart:z,alignItems:"center",display:"grid",gridTemplateColumns:"auto auto 1fr auto auto",height:(0,T.V)(32),paddingInlineEnd:(0,T.V)(8),width:"fit-content",maxWidth:(0,T.V)(400)}},A),{},{onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},children:[(0,w.jsx)("div",{style:{alignItems:"center",fontSize:0,cursor:"pointer",display:"flex",height:(0,T.V)(24),justifyContent:"center",width:(0,T.V)(24),transition:"transform linear 0.1s",transform:e.isOpen?"rotate(90deg)":"rotate(0deg)"},children:e.node.droppable&&(0,w.jsx)("div",{onClick:L,children:(0,w.jsx)(b.Z,{})})}),(0,w.jsx)("div",{children:(0,w.jsx)(S,{droppable:null!==h&&void 0!==h&&h,fileType:null===k||void 0===k?void 0:k.fileType})}),(0,w.jsx)("div",{style:{paddingInlineStart:(0,T.V)(8)},children:u?(0,w.jsxs)("div",{style:{alignItems:"center",display:"grid",gridTemplateColumns:"repeat(3, auto)",justifyContent:"flex-start"},children:[(0,w.jsx)(I,{value:P,onChange:N,size:"small",required:!0,placeholder:"Name"}),(0,w.jsx)(v.Z,{size:"small",onClick:_,disabled:""===P,children:(0,w.jsx)(Z.Z,{fontSize:"small"})}),(0,w.jsx)(v.Z,{size:"small",onClick:R,children:(0,w.jsx)(m.Z,{fontSize:"small"})})]}):(0,w.jsx)("div",{style:{alignItems:"center",display:"grid",gridTemplateColumns:"repeat(3, auto)",justifyContent:"flex-start"},children:(0,w.jsx)(g.Z,{variant:"body2",sx:{paddingRight:(0,T.V)(16)},children:e.node.text})})}),r&&!u&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{padding:"0 4px"},children:(0,w.jsx)(v.Z,{size:"small",onClick:M,children:(0,w.jsx)(j.Z,{fontSize:"small"})})}),(0,w.jsx)("div",{children:(0,w.jsx)(v.Z,{size:"small",onClick:function(){return e.onDelete(f)},children:(0,w.jsx)(C.Z,{fontSize:"small"})})})]})]}))},D=t(5574),z=t(5661),L=t(4899),M=t(5363),R=t(2861),N=t(4701),_=t(2626),A=t(7386),E=function(e){var n=(0,c.useState)(""),t=(0,l.Z)(n,2),r=t[0],a=t[1],i=(0,c.useState)(0),o=(0,l.Z)(i,2),s=o[0],u=o[1],d=(0,c.useCallback)((function(e){a(e.target.value)}),[]),p=(0,c.useCallback)((function(e){u(Number(e.target.value))}),[]);return(0,w.jsxs)(D.Z,{open:!0,onClose:e.onClose,fullWidth:!0,children:[(0,w.jsx)(z.Z,{children:"Add New Folder"}),(0,w.jsxs)(L.Z,{sx:{display:"grid",gap:(0,T.V)(16)},children:[(0,w.jsx)("div",{children:(0,w.jsx)(F.Z,{label:"Name",onChange:d,value:r,fullWidth:!0})}),(0,w.jsx)("div",{children:(0,w.jsxs)(M.Z,{sx:{width:"100%"},children:[(0,w.jsx)(R.Z,{children:"Parent"}),(0,w.jsxs)(N.Z,{label:"Parent",onChange:p,value:s,children:[(0,w.jsx)(_.Z,{value:0,children:"(top level)"}),e.tree.filter((function(e){return!0===e.droppable})).map((function(e){return(0,w.jsx)(_.Z,{value:e.id,children:e.text},e.id)}))]})]})})]}),(0,w.jsxs)(A.Z,{children:[(0,w.jsx)(f.Z,{onClick:e.onClose,children:"Cancel"}),(0,w.jsx)(f.Z,{disabled:""===r,onClick:function(){return e.onSubmit({text:r,parent:s,droppable:!0,data:{fileType:"image"}})},children:"Submit"})]})]})},W="tree_treeRoot__Coba5",H="tree_draggingSource__FYPV7",O="tree_dropTarget__r76kH",U=t(3541),G=t(5617),X=t(3739);t(8060),t(1554);var B,q=t(276),J=t(4082),K=V.styled.div(B||(B=(0,u.Z)(["\n  height: 100%;\n  ul {\n    list-style: none;\n    padding-left: 0;\n  }\n"]))),Y=function(e){var n=(0,s.Z)(e).sort((function(e,n){return e.id<n.id?1:e.id>n.id?-1:0}));return n.length>0?n[0].id:0},Q=function(e){for(var n=0,t=0;t<e.length;t++)n+=e.charCodeAt(t);return n},$=function(){var e=(0,G.eh)(),n=(0,G.eh)(),t=function(){var e=(0,c.useState)(!0),n=(0,l.Z)(e,2),t=n[0],r=n[1],o=(0,J.k)(),s=(0,l.Z)(o,2),u=s[0],d=s[1],p=(0,c.useCallback)(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,o,l,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.storageRef,o=n.folderName,r(!1),l=Object.assign(new File([],"".concat(o,"/temp.jpeg")),{preview:"",Latitude:void 0,Longitude:void 0}),s=(0,q.iH)(t,"".concat(o,"/temp.jpeg")),e.abrupt("return",u(s,l,{contentType:"image/jpeg"}).then(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(!0),n){e.next=3;break}return e.abrupt("return",void 0);case 3:if(t=null!==n&&void 0!==n&&n.ref.parent?(0,q.iH)(n.ref.parent):void 0){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.next=8,(0,q.sd)(n.ref);case 8:return i=e.sent,e.abrupt("return",{ref:t,metadata:i});case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[u]),f=(0,c.useCallback)(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.storageRef,o=n.files,r(!1),e.abrupt("return",Promise.all(o.map(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var r,i,o,l,s,c,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return s=n.name.toLowerCase().replace(/\s+/g,"-"),c=(0,q.iH)(t,s),d="image/".concat(n.type),e.abrupt("return",u(c,n,{contentType:d,customMetadata:{Latitude:null!==(r=null===(i=n.Latitude)||void 0===i?void 0:i.toString())&&void 0!==r?r:"",Longitude:null!==(o=null===(l=n.Longitude)||void 0===l?void 0:l.toString())&&void 0!==o?o:""}}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())).then((function(e){return r(!0),e})));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[u]);return{uploadManyFiles:f,createFolder:p,uploading:!t||d}}(),r=t.uploadManyFiles,u=t.createFolder,d=(t.uploading,(0,X.Z)({storageRef:e,fetchFolders:!0,fetchFiles:!0})),p=d.data,f=d.loading,h=function(e){var n,t,r,a,i=e.listItems,o=e.parent;if(!i)return[];var l=null!==(n=null===i||void 0===i||null===(t=i.folders)||void 0===t?void 0:t.map((function(e){return{id:Q(e.name),parent:o,droppable:!0,text:e.name}})))&&void 0!==n?n:[],u=null!==(r=null===i||void 0===i||null===(a=i.files)||void 0===a?void 0:a.map((function(e){return{id:Q(e.name),parent:o,text:e.name,data:{fileType:"image"}}})))&&void 0!==r?r:[];return[].concat((0,s.Z)(l),(0,s.Z)(u))}({listItems:p,parent:0}),g=(0,c.useState)([]),v=(0,l.Z)(g,2),Z=v[0],m=v[1],j=(0,c.useCallback)((function(e){return m(e)}),[]),b=(0,c.useState)(!1),C=(0,l.Z)(b,2),k=C[0],y=C[1],w=(0,c.useCallback)((function(e){var n=[e].concat((0,s.Z)((0,x.mD)(Z,e).map((function(e){return e.id})))),t=Z.filter((function(e){return!n.includes(e.id)}));m(t)}),[Z]),S=(0,c.useCallback)((function(){y(!0)}),[]),T=(0,c.useCallback)((function(){y(!1)}),[]),F=(0,c.useCallback)((function(e,n){var t=Z.map((function(t){return t.id===e?(0,o.Z)((0,o.Z)({},t),{},{text:n}):t}));m(t)}),[Z]),V=(0,c.useCallback)(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({storageRef:n,folderName:"2019"});case 2:e.sent,r=Y(Z)+1,m([].concat((0,s.Z)(Z),[(0,o.Z)((0,o.Z)({},t),{},{id:r})])),y(!1);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n,Z,r]);return(0,c.useEffect)((function(){f||m(h)}),[f]),{open:k,treeData:Z,listItemsLoading:f,handleDrop:j,handleDelete:w,handleOpenDialog:S,handleCloseDialog:T,handleTextChange:F,handleSubmit:V}},ee=function(){var e=$();return e.listItemsLoading&&(d.Z,U.l),(0,w.jsx)(d.Z,{pageName:"Manage",children:(0,w.jsx)(U.l,{children:(0,w.jsx)(p.W,{backend:x.Am,options:(0,x.bK)(),children:(0,w.jsxs)(K,{children:[(0,w.jsxs)("div",{children:[(0,w.jsx)(f.Z,{onClick:e.handleOpenDialog,startIcon:(0,w.jsx)(h.Z,{}),color:"secondary",children:"Add Folder"}),e.open&&(0,w.jsx)(E,{tree:e.treeData,onClose:e.handleCloseDialog,onSubmit:e.handleSubmit})]}),(0,w.jsx)(x.mp,{tree:e.treeData,rootId:0,render:function(n,t){return(0,w.jsx)(P,(0,o.Z)((0,o.Z)({node:n},t),{},{onDelete:e.handleDelete,onTextChange:e.handleTextChange}))},onDrop:e.handleDrop,classes:{root:W,draggingSource:H,dropTarget:O}})]})})})})}},7726:function(e,n,t){var r,a=t(9439),i=t(4942),o=t(1413),l=t(168),s=t(6934),u=t(4554),c=t(9464),d=t(977),p=t(4567),f=t(5849),h=t(4721),x=t(3236),g=t(6278),v=t(7064),Z=t(9900),m=t(9164),j=t(8654),b=t(5256),C=t(8008),k=t(1009),y=t(609),w=t(1334),S=t(2791),T=t(1849),F=t(1087),V=t(6929),I=t(184),P=(0,s.ZP)(F.rU)(r||(r=(0,l.Z)(["\n  text-decoration: none;\n  color: inherit;\n"]))),D=(0,s.ZP)(b.Z,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var n=e.theme,t=e.open;return(0,o.Z)({zIndex:n.zIndex.drawer+1,transition:n.transitions.create(["width","margin"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),borderBottom:1},t&&{marginLeft:"".concat((0,T.V)(240)),width:"calc(100% - ".concat(240,"px)"),transition:n.transitions.create(["width","margin"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen})})})),z=(0,s.ZP)(j.ZP,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var n=e.theme,t=e.open;return{"& .MuiDrawer-paper":(0,o.Z)({position:"relative",whiteSpace:"nowrap",width:"".concat((0,T.V)(240)),transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen}),boxSizing:"border-box"},!t&&(0,i.Z)({overflowX:"hidden",transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),width:n.spacing(7)},n.breakpoints.up("sm"),{width:n.spacing(9)}))}}));n.Z=function(e){var n=(0,V.a)(),t=S.useState(!0),r=(0,a.Z)(t,2),i=r[0],l=r[1],s=function(){l(!i)};return(0,I.jsxs)(u.Z,{sx:{display:"flex",backgroundColor:"white"},children:[(0,I.jsx)(D,{elevation:0,position:"absolute",open:i,children:(0,I.jsxs)(c.Z,{sx:{pr:"24px"},children:[(0,I.jsx)(d.Z,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:s,sx:(0,o.Z)({marginRight:"36px",backgroundColor:"black"},i&&{display:"none"}),children:(0,I.jsx)(C.Z,{})}),(0,I.jsx)(p.Z,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1,color:"black"},children:e.pageName}),n.user?(0,I.jsx)(f.Z,{onClick:n.logout,color:"primary",children:"Logout"}):(0,I.jsx)(f.Z,{component:F.rU,to:"/sign-in",color:"inherit",children:"Login"})]})}),(0,I.jsxs)(z,{elevation:0,variant:"permanent",open:i,children:[(0,I.jsx)(c.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",px:[1]},children:(0,I.jsx)(d.Z,{onClick:s,children:(0,I.jsx)(k.Z,{})})}),(0,I.jsx)(h.Z,{}),(0,I.jsxs)(x.Z,{component:"nav",children:[(0,I.jsx)(S.Fragment,{children:(0,I.jsx)(P,{to:"/",children:(0,I.jsxs)(g.Z,{children:[(0,I.jsx)(v.Z,{children:(0,I.jsx)(y.Z,{})}),(0,I.jsx)(Z.Z,{primary:"Home"})]})})}),(0,I.jsx)(h.Z,{sx:{my:1}}),(0,I.jsx)(S.Fragment,{children:(0,I.jsx)(P,{to:"/gallery",children:(0,I.jsxs)(g.Z,{children:[(0,I.jsx)(v.Z,{children:(0,I.jsx)(w.Z,{})}),(0,I.jsx)(Z.Z,{primary:"Gallery"})]})})}),(0,I.jsx)(h.Z,{sx:{my:1}})]})]}),(0,I.jsxs)(u.Z,{component:"main",sx:{backgroundColor:function(e){return"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900]},flexGrow:1,height:"100vh",overflow:"auto"},children:[(0,I.jsx)(c.Z,{}),(0,I.jsx)(m.Z,{maxWidth:"xl",sx:{mt:4,mb:4},children:e.children})]})]})}},3739:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(9439),a=t(276),i=t(2791),o=t(1413),l=function(e){return{loading:void 0===e||null===e,value:e}},s=function(e){var n=e?e():void 0,t=(0,i.useReducer)((function(e,n){switch(n.type){case"error":return(0,o.Z)((0,o.Z)({},e),{},{error:n.error,loading:!1,value:void 0});case"reset":return l(n.defaultValue);case"value":return(0,o.Z)((0,o.Z)({},e),{},{error:void 0,loading:!1,value:n.value});default:return e}}),l(n)),a=(0,r.Z)(t,2),s=a[0],u=a[1],c=(0,i.useCallback)((function(){var n=e?e():void 0;u({type:"reset",defaultValue:n})}),[e]),d=(0,i.useCallback)((function(e){u({type:"error",error:e})}),[]),p=(0,i.useCallback)((function(e){u({type:"value",value:e})}),[]);return(0,i.useMemo)((function(){return{error:s.error,loading:s.loading,reset:c,setError:d,setValue:p,value:s.value}}),[s.error,s.loading,c,d,p,s.value])},u=function(e,n){var t=!e&&!n,r=!!e&&!!n&&e.fullPath===n.fullPath;return t||r},c=function(e){var n=s(),t=n.error,o=n.loading,l=n.reset,c=n.setError,d=n.setValue,p=n.value,f=function(e,n,t){var r=(0,i.useRef)(e);return(0,i.useEffect)((function(){n(e,r.current)||(r.current=e,t&&t())})),r}(e.storageRef,u,l);return(0,i.useEffect)((function(){f.current?(0,a.aF)(f.current).then((function(n){return Promise.all([e.fetchFiles?Promise.all(n.items.map((function(e){return(0,a.Jt)(e)}))).then((function(e){return e.map((function(e,t){return{url:e,path:n.items[t].fullPath,name:n.items[t].name}}))})):void 0,e.fetchFolders?n.prefixes.map((function(e){return{name:e.name,path:e.fullPath}})):void 0])})).then((function(e){var n=(0,r.Z)(e,2),t=n[0],a=n[1];d({files:t,folders:a})})).catch(c):d(void 0)}),[f.current]),{data:p,loading:o,error:t}}}}]);
//# sourceMappingURL=123.a0805d1d.chunk.js.map